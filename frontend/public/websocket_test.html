<!DOCTYPE html>
<html>
<head>
  <title>WebSocket Test</title>
  <style>body{font-family:monospace;padding:20px;}</style>
</head>
<body>
  <h1>WebSocket Test Page</h1>
  <p>Testing: <code>ws://localhost:8000/ws/chat/1?token=test</code></p>
  <button onclick="connect()">Connect</button>
  <button onclick="disconnect()" disabled>Disconnect</button>
  <pre id="log" style="height:300px;overflow:auto;"></pre>
  <script>
    const log = document.getElementById('log');
    let ws = null;
    function connect() {
      log.textContent = '';
      ws = new WebSocket('ws://localhost:8000/ws/chat/1?token=test');
      ws.onopen = () => { log.textContent += 'âœ… CONNECTED\n'; };
      ws.onmessage = (e) => { log.textContent += 'ðŸ“© MESSAGE: ' + e.data + '\n'; };
      ws.onclose = (e) => { log.textContent += 'âŒ CLOSED: ' + e.code + ' (' + e.reason + ')\n'; };
      ws.onerror = (e) => { log.textContent += 'ðŸ’¥ ERROR: ' + e.message + '\n'; };
      document.querySelector('button[onclick="connect()"]').disabled = true;
      document.querySelector('button[onclick="disconnect()"]').disabled = false;
    }
    function disconnect() {
      if (ws) ws.close();
      document.querySelector('button[onclick="connect()"]').disabled = false;
      document.querySelector('button[onclick="disconnect()"]').disabled = true;
    }
  </script>
</body>
</html>