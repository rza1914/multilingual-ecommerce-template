import{r as e,j as s,a7 as a,a as t,u as r,a8 as l,o as d,b as c}from"./react-vendor.B-6_bSeD.js";import{d as i,u as n,b as o,c as x,h as m,e as g,f as u,i as h}from"./index.CiTXjkB3.js";import{g as p}from"./api.PPy2Mpfq.js";import"./vendor.CIrfaz5f.js";import"./utils-vendor.CnGjioV-.js";import"./i18n-vendor.C0y6bc4v.js";const b=({productId:a})=>{const[t,r]=e.useState(null),[l,d]=e.useState(!0),[c,n]=e.useState(null);i();const o=localStorage.getItem("auth_token");e.useEffect(()=>{x()},[a]);const x=async()=>{try{d(!0),n(null);const e=await fetch(p(`/products/${a}/recommendations`),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const s=await e.json();r(s)}catch(e){n("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ù‡Ø§. Ù„Ø·ÙØ§Ù‹ Ø¨Ø¹Ø¯Ø§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯.")}finally{d(!1)}},m=e=>new Intl.NumberFormat("fa-IR").format(e);if(l)return s.jsx("div",{className:"py-8",children:s.jsx("div",{className:"animate-pulse flex space-x-4",children:s.jsxs("div",{className:"flex-1 space-y-4 py-1",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[...Array(4)].map((e,a)=>s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsx("div",{className:"bg-gray-200 rounded-lg h-40 w-full mb-4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),s.jsx("div",{className:"h-10 bg-gray-200 rounded w-full"})]},a))})]})})});if(c)return s.jsx("div",{className:"py-8 text-center text-red-500",children:c});if(!t)return s.jsx("div",{className:"py-8 text-center text-gray-500",children:"Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯"});const g=(e,a,t)=>a&&0!==a.length?s.jsxs("div",{className:"mb-10",children:[s.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center",children:[s.jsx("span",{className:"ml-2",children:t}),e]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:a.map(e=>s.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300 border border-gray-100",children:[e.image_url?s.jsx("img",{src:e.image_url,alt:e.title,className:"w-full h-40 object-contain p-2 bg-gray-50"}):s.jsx("div",{className:"w-full h-40 flex items-center justify-center bg-gray-100",children:s.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-16 h-16"})}),s.jsxs("div",{className:"p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-800 truncate",children:e.title}),s.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",children:e.reason}),s.jsxs("div",{className:"mt-2 flex items-center",children:[s.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[m(e.price)," ØªÙˆÙ…Ø§Ù†"]}),e.discount_price&&e.discount_price<e.price&&s.jsxs("span",{className:"ml-2 text-sm text-red-500 line-through",children:[m(e.price)," ØªÙˆÙ…Ø§Ù†"]})]}),e.rating&&s.jsxs("div",{className:"mt-1 flex items-center",children:[s.jsxs("span",{className:"text-yellow-500",children:["â­ ",e.rating.toFixed(1)]}),s.jsxs("span",{className:"text-xs text-gray-500 mr-2",children:["(",e.stock," Ù…ÙˆØ¬ÙˆØ¯)"]})]}),s.jsx("button",{onClick:()=>{e.id},className:"mt-3 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition-colors duration-300 text-sm",children:"Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯"})]})]},e.id))})]}):null;return s.jsxs("div",{className:"py-8",children:[s.jsx("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-100",children:s.jsx("p",{className:"text-blue-800",children:t.explanation})}),g("Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ø±ØªØ¨Ø·",t.related,"ðŸ”—"),g("Ø§Ú©Ø³Ø³ÙˆØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ",t.accessories,"ðŸŽ"),g("Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ø¨Ù‡ØªØ±",t.upsell,"â¬†ï¸"),g("Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ø§Ø±Ø²Ø§Ù†â€ŒØªØ±",t.downsell,"â¬‡ï¸")]})},j=()=>{const{id:i}=a(),p=t(),{addToCart:j}=n(),{t:y}=r(),[N,f]=e.useState(null),[v,k]=e.useState(1),[w,S]=e.useState(!0),[P,D]=e.useState(null);e.useEffect(()=>{(async()=>{try{if(S(!0),D(null),i){const e=parseInt(i,10),s=await h(e);f(s)}}catch(e){D(y("productDetailPage.errorLoading"))}finally{S(!1)}})()},[i,y]);if(w)return s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"})});if(P)return s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:P}),s.jsx("button",{onClick:()=>p("/products"),className:"btn-primary",children:y("productDetailPage.backToProducts")})]})});if(!N)return s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{children:y("productDetailPage.productNotFound")}),s.jsx("button",{onClick:()=>p("/products"),className:"btn-primary mt-4",children:y("productDetailPage.backToProducts")})]})});const C=N.discount&&N.discount>0,T=C?N.price*(1-(N.discount||0)/100):N.price,$=0===N.stock,_=N.stock>0&&N.stock<10,I=o(N),E=x(N);return s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 animate-fade-in",children:s.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[s.jsxs("button",{onClick:()=>p("/products"),className:"flex items-center gap-2 text-gray-600 dark:text-gray-300 hover:text-orange-500 dark:hover:text-orange-400 mb-6 transition-colors",children:[s.jsx(l,{className:"w-5 h-5"}),s.jsx("span",{children:y("productDetailPage.backToProducts")})]}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden",children:s.jsxs("div",{className:"grid md:grid-cols-2 gap-8 p-6 md:p-8",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-xl p-4 flex items-center justify-center h-full min-h-[400px]",children:s.jsx("img",{src:g(N.image_url),alt:I,onError:m,className:"max-h-96 object-contain rounded-lg"})}),s.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[C&&s.jsx("span",{className:"bg-red-100 text-red-800 text-xs font-semibold px-2.5 py-0.5 rounded",children:y("productDetailPage.discount",{discount:N.discount})}),N.is_featured&&s.jsxs("span",{className:"bg-yellow-100 text-yellow-800 text-xs font-semibold px-2.5 py-0.5 rounded",children:[s.jsx(d,{className:"w-3 h-3 inline mr-1"}),y("product.featured")]}),$?s.jsx("span",{className:"bg-red-100 text-red-800 text-xs font-semibold px-2.5 py-0.5 rounded",children:y("product.outOfStock")}):_?s.jsx("span",{className:"bg-orange-100 text-orange-800 text-xs font-semibold px-2.5 py-0.5 rounded",children:y("product.lowStock",{count:N.stock})}):s.jsx("span",{className:"bg-green-100 text-green-800 text-xs font-semibold px-2.5 py-0.5 rounded",children:y("product.inStock")})]})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm text-orange-600 dark:text-orange-400 font-medium mb-2",children:N.category||y("productDetailPage.uncategorized")}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:I}),N.rating&&N.rating>0&&s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("div",{className:"flex",children:[...Array(5)].map((e,a)=>s.jsx(d,{className:"w-5 h-5 "+(a<Math.floor(N.rating||0)?"fill-yellow-400 text-yellow-400":"text-gray-300 dark:text-gray-600")},a))}),s.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:["(",N.rating.toFixed(1),") â€¢ ",N.stock," ",y("productDetailPage.inStock")]})]}),s.jsxs("div",{className:"flex items-baseline gap-3 mb-6",children:[s.jsx("span",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400",children:u(T)}),C&&s.jsx("span",{className:"text-lg text-gray-500 dark:text-gray-400 line-through",children:u(N.price)})]}),s.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-8",children:E}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:y("productDetailPage.quantity")}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>k(Math.max(1,v-1)),className:"p-2 bg-gray-200 dark:bg-gray-700 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600",disabled:v<=1,children:s.jsx("span",{className:"text-lg",children:"-"})}),s.jsx("span",{className:"text-xl font-bold w-12 text-center",children:v}),s.jsx("button",{onClick:()=>k(Math.min(N.stock,v+1)),className:"p-2 bg-gray-200 dark:bg-gray-700 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600",disabled:v>=N.stock,children:s.jsx("span",{className:"text-lg",children:"+"})})]})]}),s.jsxs("button",{onClick:()=>{N&&j(N,v)},disabled:$,className:"flex items-center justify-center gap-2 py-3 px-6 rounded-xl font-semibold mb-6 "+($?"bg-gray-300 dark:bg-gray-600 text-gray-500 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600 text-white"),children:[s.jsx(c,{className:"w-5 h-5"}),$?y("product.outOfStock"):`${y("productDetailPage.addToCart")} â€¢ ${u(T*v)}`]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-xl",children:[s.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:y("productDetailPage.sku")}),s.jsxs("div",{className:"font-semibold",children:["#",N.id.toString().padStart(6,"0")]})]}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-xl",children:[s.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:y("productDetailPage.availability")}),s.jsx("div",{className:"font-semibold "+($?"text-red-500":_?"text-orange-500":"text-green-500"),children:$?y("product.outOfStock"):_?`${y("product.lowStock",{count:N.stock})}`:`${y("product.inStock")} (${N.stock})`})]})]})]})]})}),s.jsx("div",{className:"mt-12",children:s.jsx(b,{productId:N.id})})]})})};export{j as default};
