import{u as e,a as r,r as a,j as s,U as t,ag as l,ac as n,w as o,aj as d,X as i,ak as c,e as x,z as g,L as m,E as p,f as h}from"./react-vendor.B-6_bSeD.js";import{j as b,A as u,d as f}from"./index.CiTXjkB3.js";import{a as y}from"./order.service.Bwm3-Kzy.js";import"./vendor.CIrfaz5f.js";import"./utils-vendor.CnGjioV-.js";import"./i18n-vendor.C0y6bc4v.js";const j=async()=>await b.get(u.ENDPOINTS.USERS.ME);function w(){const{t:w}=e(),N=r(),{isAuthenticated:v}=f(),[k,_]=a.useState(null),[S,C]=a.useState([]),[P,E]=a.useState(!0),[D,U]=a.useState(!1),[A,F]=a.useState(!1),[M,O]=a.useState({full_name:"",phone:""}),[I,L]=a.useState({current_password:"",new_password:"",confirm_password:""}),[R,T]=a.useState({current:!1,new:!1,confirm:!1}),[H,$]=a.useState(!1),[z,B]=a.useState(!1);a.useEffect(()=>{v?q():N("/")},[v]);const q=async()=>{try{const[e,r]=await Promise.all([j(),y()]);_(e),C(r),O({full_name:e.full_name||"",phone:e.phone||""})}catch(e){}finally{E(!1)}};if(P)return s.jsx("div",{className:"min-h-screen pt-24 pb-12 px-4",children:s.jsx("div",{className:"max-w-6xl mx-auto",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:w("profile.loadingProfile")})]})})})});if(!k)return s.jsx("div",{className:"min-h-screen pt-24 pb-12 px-4",children:s.jsxs("div",{className:"max-w-6xl mx-auto text-center",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:w("profile.notFound")}),s.jsx("button",{onClick:()=>N("/"),className:"px-6 py-3 bg-orange-500 text-white rounded-xl font-semibold hover:bg-orange-600",children:w("profile.goHome")})]})});const G=S.length,J=S.filter(e=>"pending"===e.status).length,K=S.filter(e=>"delivered"===e.status).length,Q=S.reduce((e,r)=>e+r.total,0);return s.jsx("div",{className:"min-h-screen pt-24 pb-12 px-4 bg-gray-50 dark:bg-gray-950",children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-2",children:w("profile.title")}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:w("profile.subtitle")})]}),s.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl p-6 shadow-lg border-2 border-gray-100 dark:border-gray-800 text-center",children:[s.jsx("div",{className:"w-24 h-24 mx-auto rounded-full bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center mb-4 shadow-xl",children:s.jsx(t,{className:"w-12 h-12 text-white"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:k.full_name||w("profile.user")}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:k.email}),s.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[s.jsx(l,{className:"w-4 h-4"}),s.jsxs("span",{children:[w("profile.joined")," ",(V=k.created_at,new Date(V).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}))]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl p-6 shadow-lg border-2 border-gray-100 dark:border-gray-800",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:w("profile.orderStatistics")}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 dark:bg-orange-900/20 rounded-xl",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(n,{className:"w-5 h-5 text-orange-500"}),s.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:w("profile.totalOrders")})]}),s.jsx("span",{className:"text-xl font-bold text-orange-500",children:G})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-xl",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(o,{className:"w-5 h-5 text-blue-500"}),s.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:w("profile.pending")})]}),s.jsx("span",{className:"text-xl font-bold text-blue-500",children:J})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-xl",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(o,{className:"w-5 h-5 text-green-500"}),s.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:w("profile.delivered")})]}),s.jsx("span",{className:"text-xl font-bold text-green-500",children:K})]}),s.jsx("div",{className:"pt-4 border-t-2 border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-700 dark:text-gray-300 font-semibold",children:w("profile.totalSpent")}),s.jsxs("span",{className:"text-2xl font-bold text-orange-500",children:["$",Q.toFixed(2)]})]})})]}),s.jsx("button",{onClick:()=>N("/orders"),className:"w-full mt-4 px-4 py-3 bg-orange-500 text-white rounded-xl font-semibold hover:bg-orange-600 transition-colors",children:w("profile.viewAllOrders")})]})]}),s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl p-8 shadow-lg border-2 border-gray-100 dark:border-gray-800",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:w("profile.personalInfo")}),D?s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>{U(!1),O({full_name:k.full_name||"",phone:k.phone||""})},className:"flex items-center gap-2 px-4 py-2 border-2 border-gray-300 dark:border-gray-700 rounded-xl font-semibold hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[s.jsx(i,{className:"w-4 h-4"}),w("profile.cancel")]}),s.jsx("button",{onClick:async()=>{$(!0);try{const e=await(async e=>await b.put(u.ENDPOINTS.USERS.ME,e))(M);_(e),U(!1),alert(w("profile.profileUpdated"))}catch(e){alert(w("profile.updateProfileError"))}finally{$(!1)}},disabled:H,className:"flex items-center gap-2 px-4 py-2 bg-orange-500 text-white rounded-xl font-semibold hover:bg-orange-600 transition-colors disabled:opacity-50",children:H?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),w("profile.saving")]}):s.jsxs(s.Fragment,{children:[s.jsx(c,{className:"w-4 h-4"}),w("profile.save")]})})]}):s.jsxs("button",{onClick:()=>U(!0),className:"flex items-center gap-2 px-4 py-2 text-orange-500 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded-xl transition-colors font-semibold",children:[s.jsx(d,{className:"w-4 h-4"}),w("profile.edit")]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:w("profile.fullName")}),D?s.jsx("input",{type:"text",autoComplete:"name",value:M.full_name,onChange:e=>O({...M,full_name:e.target.value}),className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 rounded-xl focus:border-orange-500 focus:outline-none"}):s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl",children:[s.jsx(t,{className:"w-5 h-5 text-gray-500"}),s.jsx("span",{className:"text-gray-900 dark:text-white",children:k.full_name||w("profile.notSet")})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:w("profile.emailAddress")}),s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl",children:[s.jsx(x,{className:"w-5 h-5 text-gray-500"}),s.jsx("span",{className:"text-gray-900 dark:text-white",children:k.email}),s.jsx("span",{className:"ml-auto text-xs text-gray-500 dark:text-gray-400",children:w("profile.cannotBeChanged")})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:w("profile.phoneNumber")}),D?s.jsx("input",{type:"tel",autoComplete:"tel",value:M.phone,onChange:e=>O({...M,phone:e.target.value}),placeholder:w("profile.phonePlaceholder"),className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 rounded-xl focus:border-orange-500 focus:outline-none"}):s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl",children:[s.jsx(g,{className:"w-5 h-5 text-gray-500"}),s.jsx("span",{className:"text-gray-900 dark:text-white",children:k.phone||w("profile.notSet")})]})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl p-8 shadow-lg border-2 border-gray-100 dark:border-gray-800",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:w("profile.changePassword")}),!A&&s.jsxs("button",{onClick:()=>F(!0),className:"flex items-center gap-2 px-4 py-2 text-orange-500 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded-xl transition-colors font-semibold",children:[s.jsx(m,{className:"w-4 h-4"}),w("profile.change")]})]}),A?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:w("profile.currentPassword")}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:R.current?"text":"password",autoComplete:"current-password",value:I.current_password,onChange:e=>L({...I,current_password:e.target.value}),className:"w-full px-4 py-3 pr-12 bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 rounded-xl focus:border-orange-500 focus:outline-none"}),s.jsx("button",{type:"button",onClick:()=>T({...R,current:!R.current}),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:R.current?s.jsx(p,{className:"w-5 h-5"}):s.jsx(h,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:w("profile.newPassword")}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:R.new?"text":"password",autoComplete:"new-password",value:I.new_password,onChange:e=>L({...I,new_password:e.target.value}),className:"w-full px-4 py-3 pr-12 bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 rounded-xl focus:border-orange-500 focus:outline-none"}),s.jsx("button",{type:"button",onClick:()=>T({...R,new:!R.new}),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:R.new?s.jsx(p,{className:"w-5 h-5"}):s.jsx(h,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:w("profile.confirmNewPassword")}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:R.confirm?"text":"password",autoComplete:"new-password",value:I.confirm_password,onChange:e=>L({...I,confirm_password:e.target.value}),className:"w-full px-4 py-3 pr-12 bg-gray-50 dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 rounded-xl focus:border-orange-500 focus:outline-none"}),s.jsx("button",{type:"button",onClick:()=>T({...R,confirm:!R.confirm}),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:R.confirm?s.jsx(p,{className:"w-5 h-5"}):s.jsx(h,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>{F(!1),L({current_password:"",new_password:"",confirm_password:""})},className:"flex-1 px-4 py-3 border-2 border-gray-300 dark:border-gray-700 rounded-xl font-semibold hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:w("profile.cancel")}),s.jsx("button",{onClick:async()=>{var e,r;if(I.current_password&&I.new_password)if(I.new_password.length<6)alert(w("profile.passwordMinLength"));else if(I.new_password===I.confirm_password){B(!0);try{await(async e=>{await b.put(`${u.ENDPOINTS.USERS.ME}/password`,e)})({current_password:I.current_password,new_password:I.new_password}),F(!1),L({current_password:"",new_password:"",confirm_password:""}),alert(w("profile.passwordChanged"))}catch(a){alert((null==(r=null==(e=a.response)?void 0:e.data)?void 0:r.detail)||w("profile.changePasswordError"))}finally{B(!1)}}else alert(w("profile.passwordsDoNotMatch"));else alert(w("profile.fillAllPasswordFields"))},disabled:z,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl font-semibold hover:bg-orange-600 transition-colors disabled:opacity-50",children:z?s.jsxs("span",{className:"flex items-center justify-center gap-2",children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),w("profile.saving")]}):w("profile.updatePassword")})]})]}):s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:w("profile.changePasswordHint")})]})]})]})]})});var V}export{w as default};
